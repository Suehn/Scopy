# v0.10.5 - 智能设计系统

## 📌 一页纸总结

### What
建立基于基础值 + 偏移量的智能尺寸系统，让所有 UI 元素尺寸可以通过计算得出，方便统一控制和调整。

### Why
- 硬编码尺寸值散落各处（3, 10, 16, 18, 20, 30, 32, 320, 400...）
- 修改一个尺寸需要找遍所有文件
- 缺乏语义化命名，难以理解每个数值的用途
- 无法统一缩放 UI

### Result
- 新增 `ScopySize.swift` 统一尺寸系统
- 基于 4pt 网格，所有尺寸都是 `unit * N`
- 语义化命名：`ScopySize.Icon.listApp` 比 `20` 更易理解
- 修改 `unit` 可以缩放整个 UI

---

## 🏗️ 实现路线

1. ✅ 创建 `ScopySize.swift` - 统一尺寸系统
2. ✅ 替换 `HeaderView.swift` 中的硬编码值
3. ✅ 替换 `HistoryListView.swift` 中的硬编码值
4. ✅ 替换 `FooterView.swift` 中的硬编码值
5. ✅ 替换 `ContentView.swift` 中的硬编码值
6. ✅ 构建验证

---

## 📂 核心改动

### 新增文件

| 文件 | 说明 |
|------|------|
| `Scopy/Design/ScopySize.swift` | 统一尺寸系统（70 行） |

### 修改文件

| 文件 | 改动 |
|------|------|
| `Scopy/Views/HeaderView.swift` | 6 处硬编码值替换为 ScopySize |
| `Scopy/Views/HistoryListView.swift` | 10 处硬编码值替换为 ScopySize |
| `Scopy/Views/FooterView.swift` | 5 处硬编码值替换为 ScopySize |
| `Scopy/Views/ContentView.swift` | 1 处窗口尺寸替换为 ScopySize |

---

## 🎯 ScopySize 系统设计

### 基础单位
```swift
static let unit: CGFloat = 4  // 4pt 网格系统
```

### 图标尺寸 (Icon)
| 名称 | 计算 | 值 | 用途 |
|------|------|-----|------|
| xs | unit * 3 | 12pt | 小图标 |
| sm | unit * 4 | 16pt | 标准小图标 |
| md | unit * 5 | 20pt | 列表项图标 |
| lg | unit * 6 | 24pt | 大图标 |
| xl | unit * 8 | 32pt | 特大图标 |
| header | unit * 4.5 | 18pt | Header 搜索图标 |
| filter | unit * 4 | 16pt | 过滤按钮图标 |
| listApp | unit * 5 | 20pt | 列表 App 图标 |
| menuApp | unit * 4.5 | 18pt | 菜单 App 图标 |
| pin | unit * 2.5 | 10pt | Pin 图标 |
| empty | unit * 5 | 20pt | 空状态图标 |

### 圆角 (Corner)
| 名称 | 计算 | 值 |
|------|------|-----|
| xs | unit * 0.5 | 2pt |
| sm | unit * 1 | 4pt |
| md | unit * 1.5 | 6pt |
| lg | unit * 2 | 8pt |
| xl | unit * 2.5 | 10pt |

### 组件高度 (Height)
| 名称 | 计算 | 值 | 用途 |
|------|------|-----|------|
| listItem | unit * 9 | 36pt | 列表项最小高度 |
| header | unit * 11 | 44pt | Header 高度 |
| footer | unit * 8 | 32pt | Footer 高度 |
| loadMore | unit * 7.5 | 30pt | 加载更多高度 |
| divider | unit * 4 | 16pt | 分隔线高度 |
| pinIndicator | unit * 5 | 20pt | Pin 指示条高度 |

### 宽度 (Width)
| 名称 | 计算 | 值 | 用途 |
|------|------|-----|------|
| pinIndicator | unit * 0.75 | 3pt | Pin 指示条宽度 |
| settingsLabel | unit * 30 | 120pt | 设置标签宽度 |
| statLabel | unit * 12.5 | 50pt | 统计标签宽度 |

### 窗口尺寸 (Window)
| 名称 | 计算 | 值 |
|------|------|-----|
| mainWidth | unit * 80 | 320pt |
| mainHeight | unit * 100 | 400pt |
| settingsWidth | unit * 180 | 720pt |
| settingsHeight | unit * 130 | 520pt |

---

## 🎯 关键指标

### 代码质量
- 硬编码值替换: **22 处**
- 新增设计系统文件: **1 个**
- 构建状态: **✅ 成功**

### 测试
- 单元测试: **145/146 passed** (1 skipped, 无新增失败)

---

## 📊 当前状态

| 项目 | 状态 |
|------|------|
| 构建 | ✅ Debug 成功 |
| 部署 | ✅ /Applications/Scopy.app |
| 测试 | ✅ 145/146 passed |

---

## 🔮 遗留与后续

### 已完成
- [x] 创建 ScopySize 统一尺寸系统
- [x] 替换主要视图中的硬编码值
- [x] 构建验证

### 后续可选
- [ ] 替换 SettingsView.swift 中的硬编码值
- [ ] 更新 ScopyTypography 使用 baseSize 计算
- [ ] 添加 ScopySize 单元测试验证计算正确性

---

**完成时间**: 2025-11-28
**维护者**: Claude Code
