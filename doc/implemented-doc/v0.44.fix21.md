# v0.44.fix21

## ğŸ“Œ ä¸€é¡µçº¸æ€»ç»“ï¼ˆWhat / Why / Resultï¼‰

### What

- Fix/Clipboard Ingestï¼šå¯¹ `.html/.rtf` ç±»å‹æ¡ç›®ï¼Œå½“ pasteboard çš„ `.string` ä¸ rich payload æå–çš„çº¯æ–‡æœ¬ä¸ä¸€è‡´ä¸”å¯Œæ–‡æœ¬åŒ…å« TeX å‘½ä»¤æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ rich payload çš„çº¯æ–‡æœ¬ä½œä¸º `plainText`ï¼Œé¿å…æŠŠâ€œå¯Œæ–‡æœ¬â†’Markdownâ€åçš„ä¼ªå½±ï¼ˆå¦‚ `==========`ã€`\sum*{...}`ã€`\mathbf{e}*i`ï¼‰å†™å…¥å†å²ã€‚

### Why

- macOS pasteboard åŒä¸€æ¡å¤åˆ¶å¯åŒæ—¶åŒ…å« `.string` ä¸ `.html/.rtf`ã€‚éƒ¨åˆ†æ¥æº App ä¼šæŠŠ `.string` å¡«æˆâ€œç”±å¯Œæ–‡æœ¬è½¬æ¢å¾—åˆ°çš„ Markdown é£æ ¼æ–‡æœ¬â€ï¼Œè¯¥è½¬æ¢ä¸ç†è§£ LaTeX æ•°å­¦è¯­ä¹‰ï¼Œå®¹æ˜“æŠŠ `_`/`^` å½“ä½œ Markdown è¯­æ³•ï¼Œä»è€Œäº§ç”Ÿå¤§é‡ `=====` ä¸ `*` ä¼ªå½±ã€‚
- Scopy çš„å»é‡/ç´¢å¼•ä¸åç»­å¤åˆ¶ä¾èµ– `plainText`ï¼ˆv0.md 3.2ï¼‰ã€‚ä¸€æ—¦ ingest æ—¶æŠŠæ±¡æŸ“çš„ `.string` å½“ä½œ `plainText`ï¼Œé”™ä¹±å†…å®¹ä¼šè¢«æŒä¹…åŒ–å¹¶åœ¨æœç´¢/å¤åˆ¶ä¸­ç»§ç»­ä¼ æ’­ã€‚

### Result

- `.string` ä»ä¼˜å…ˆï¼ˆä¿æŒæ—¢æœ‰è¡Œä¸ºï¼‰ï¼›ä½†å½“ `.string` ä¸ rich payload æå–ç»“æœä¸ä¸€è‡´ä¸” extracted åŒ…å« TeX å‘½ä»¤æ—¶ï¼Œæ”¹ç”¨ extracted ä½œä¸º `plainText`ï¼Œé¿å…æŠŠ Markdown è½¬æ¢äº§ç‰©å†™å…¥å†å²ã€‚
- æ–°å¢å›å½’æµ‹è¯•ï¼šæ„é€ â€œrich æ­£å¸¸ä½† `.string` å·²æ±¡æŸ“â€çš„ HTML/RTF è¾“å…¥ï¼ŒéªŒè¯è¯»åˆ°çš„ `plainText` ä¿ç•™ `\sum_{...}` ç­‰ TeX è¯­ä¹‰ä¸”ä¸åŒ…å« `\sum*{`/`==========`ã€‚

---

## ğŸ—ï¸ å®ç°è·¯çº¿

1. åœ¨ `ClipboardMonitor` çš„ `.html/.rtf` ingest è·¯å¾„å¼•å…¥ `extractPreferredPlainText(...)`ï¼šåŒæ—¶è¯»å– `.string` ä¸ rich payload æå–æ–‡æœ¬ï¼Œå¹¶æŒ‰â€œä¸ä¸€è‡´ + TeXâ€åŸåˆ™é€‰å–æ›´å¯ä¿¡çš„ `plainText`ã€‚
2. å¢åŠ  HTML/RTF ä¸¤æ¡å•æµ‹ï¼Œè¦†ç›–â€œ`.string` è¢«æ±¡æŸ“ä½† rich ä¿æŒæ­£ç¡®â€çš„å›å½’åœºæ™¯ã€‚

---

## ğŸ“‚ æ ¸å¿ƒæ”¹åŠ¨

- `Scopy/Services/ClipboardMonitor.swift`
  - `.rtf/.html` çš„ `plainText` é€‰æ‹©ï¼š`.string` ä¸ extracted ä¸ä¸€è‡´ä¸” extracted å« TeX å‘½ä»¤ â†’ ä½¿ç”¨ extractedã€‚
- `ScopyTests/ClipboardMonitorTests.swift`
  - æ–°å¢ HTML/RTF ä¸¤æ¡å›å½’æµ‹è¯•ï¼Œè¦†ç›– â€œ`.string` å·²æ±¡æŸ“ä½† rich æ­£å¸¸â€ çš„ ingest è¡Œä¸ºã€‚

---

## ğŸ¯ å…³é”®æŒ‡æ ‡

- å•å…ƒæµ‹è¯•ï¼š`make test-unit`ï¼šExecuted 204 tests, 1 skipped, 0 failures

---

## ğŸ“Š å½“å‰çŠ¶æ€

- å‰ªè´´æ¿ ingestï¼šå½“ `.string` è¢« Markdown è½¬æ¢æ±¡æŸ“è€Œ `.html/.rtf` ä»æ­£ç¡®æ—¶ï¼Œå†å² `plainText` ä»ä¿æŒå¯ç”¨çš„ TeX è¯­ä¹‰ã€‚

---

## ğŸ”® é—ç•™ä¸åç»­

- è‹¥æœªæ¥å‘ç°â€œé TeX åœºæ™¯ä¹Ÿå­˜åœ¨ `.string` è¢«è½¬æ¢æ±¡æŸ“â€çš„æ¥æºï¼Œå¯åœ¨ä¸æ”¹å˜åŸåˆ™çš„å‰æä¸‹æ‰©å±•â€œå¯ä¿¡åº¦åˆ¤å®šâ€ï¼ˆä¾‹å¦‚æŒ‰æ¥æº app ç»´åº¦åšç­–ç•¥æˆ–å¢åŠ ç”¨æˆ·å¯é…ç½®å¼€å…³ï¼‰ã€‚
