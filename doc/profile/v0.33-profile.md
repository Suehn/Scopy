# v0.33 性能对比（v0.32 → v0.33）

**日期**: 2025-12-13

## 对比版本

- v0.32 → v0.33

## 测试环境

- 设备：Apple M3
- 系统：macOS 15.7.2（24G325）
- 架构：arm64
- 配置：Debug
- 命令：`make test-perf`（`RUN_PERF_TESTS=1`）
- 备注：heavy 场景需 `RUN_HEAVY_PERF_TESTS=1` 才运行

## 性能对比表格

> 说明：v0.33 本次改动集中在“Application 门面 + 事件语义”，未改动 Search/Storage 的核心算法；磁盘类 perf 用例受系统负载影响较大，建议以多次跑的范围值判断趋势。

| 指标 | v0.32 | v0.33 |
|------|------:|------:|
| Fuzzy 5k items P95 | 4.85ms | 8.21ms |
| Fuzzy 10k items P95 | 45.07ms | 78.76ms |
| Disk 25k fuzzy P95 | 57.28ms | 107.50ms |
| Bulk insert 1000 items | 54.73ms（≈18,272 items/s） | 83.15ms（≈12,027 items/s） |
| Fetch recent (50 items) avg | 0.07ms | 0.11ms |
| Regex 20k items P95 | 3.39ms | 5.19ms |

## 测试用例变化

- 无新增/删除性能用例；v0.33 为 Phase 4（ClipboardService actor + 事件语义纯化）记录基线。

## 性能回归说明

- 本次变更未触及 SearchEngineImpl/SQLiteClipboardRepository 核心实现；若上述指标在多次运行中持续偏高，建议优先排查：
  - 测试运行时系统负载（后台任务/Spotlight/Time Machine）
  - 磁盘缓存与临时目录抖动
  - Xcode/DerivedData 状态与首次运行冷启动影响

## 总结

- v0.33 主要交付为架构与事件语义的确定性（清空不再触发 settingsChanged），性能以 `make test-perf` 实测为准；heavy 场景可按需单独开启验证。

