# v0.50.fix7 - Performance Profile

日期：2025-12-19

对比版本：v0.50.fix6 → v0.50.fix7

环境：
- `hw.model=Mac15,12`
- 内存：24GB
- macOS 15.7.2（24G325）
- Xcode 16.3（16E140）

## 结论（摘要）

- DisplayText 预热将 title/metadata 的文本扫描从滚动路径挪到后台，降低快速滚动进入新页时的主线程开销。
- 本次未跑完整搜索/清理/写入/内存基准，仅记录滚动相关指标；需补跑 `RUN_PERF_TESTS=1` 获取完整对比矩阵。

## 指标

| 场景 | 指标 | 结果 |
|------|------|------|
| Scroll state update（1000 samples） | P95 | 1.07 μs |
| Scroll state update（1000 samples） | Mean | 0.31 μs |
| Scroll state update（1000 samples） | Max | 1.07 μs |
| DisplayText metadata access（400 items × 4096 chars） | cold | 324.58 ms |
| DisplayText metadata access（400 items × 4096 chars） | cached | 204.92 μs |

## 测试命令

- `xcodebuild test -project Scopy.xcodeproj -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests`
- `xcodebuild test -project Scopy.xcodeproj -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/ScrollPerformanceTests/testScrollStatePerformance`
- `xcodebuild test -project Scopy.xcodeproj -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/ScrollPerformanceTests/testDisplayTextPrewarmImprovesMetadataAccessTime`

## 备注

- 性能矩阵（搜索/清理/写入/内存）未执行：`RUN_PERF_TESTS` 未设置。
