# v0.50.fix19

> çŠ¶æ€ï¼šâœ…
> è¯´æ˜ï¼šFix/Statsï¼šå½“ç”¨æˆ·åœ¨åº”ç”¨å¤–éƒ¨è¦†ç›–/å‹ç¼© `content/` ä¸‹çš„å›¾ç‰‡åï¼Œè‡ªåŠ¨åŒæ­¥ DB çš„ `size_bytes`ï¼Œä¿®å¤ Footer â€œå†…å®¹ä¼°ç®—/ç£ç›˜å ç”¨â€æ˜¾ç¤ºä¸ä¸€è‡´ï¼Œå¹¶é¿å…æŒ‰ä¼°ç®—ä¸Šé™è§¦å‘çš„è¯¯æ¸…ç†ã€‚

## ğŸ“Œ ä¸€é¡µçº¸æ€»ç»“ï¼ˆWhat / Why / Resultï¼‰

### What

- Fix/Statsï¼šæ–°å¢å¤–éƒ¨å›¾ç‰‡ `size_bytes` åŒæ­¥ï¼šä»ç£ç›˜è¯»å–çœŸå®æ–‡ä»¶å¤§å°å¹¶æ‰¹é‡å†™å› DBã€‚
- UXï¼šåœ¨åˆ·æ–°ç»Ÿè®¡åæ£€æµ‹åˆ°â€œä¼°ç®—æ˜æ˜¾å¤§äºç£ç›˜å ç”¨â€æ—¶ï¼Œåå°è‡ªåŠ¨è§¦å‘åŒæ­¥ï¼Œå¹¶åˆ·æ–° Footer çš„ä¼°ç®—å€¼ã€‚

### Why

- ç”¨æˆ·å¯èƒ½åœ¨åº”ç”¨å¤–éƒ¨æ‰¹é‡ä¼˜åŒ– `content/` ç›®å½•å›¾ç‰‡ï¼ˆä¾‹å¦‚ pngquant è¦†ç›–åŸå›¾ï¼‰ï¼Œå¯¼è‡´ç£ç›˜å ç”¨å˜å°ï¼Œä½† DB çš„ `size_bytes` ä»æ˜¯æ—§å€¼ã€‚
- æ—§å€¼ä¼šé€ æˆä¸¤ä¸ªé—®é¢˜ï¼š
  - Footer å‡ºç°â€œå†…å®¹ä¼°ç®— > ç£ç›˜å ç”¨â€çš„åç›´è§‰æ˜¾ç¤ºï¼›
  - ä»¥â€œå†…å®¹ä¼°ç®—ä¸Šé™â€ä¸ºä¾æ®çš„è‡ªåŠ¨æ¸…ç†å¯èƒ½è¯¯åˆ¤å¹¶åˆ é™¤å¤§é‡å†å²ã€‚

### Result

- â€œå†…å®¹ä¼°ç®—â€ä¼šåœ¨æ£€æµ‹åˆ°æ˜æ˜¾ä¸ä¸€è‡´æ—¶è‡ªåŠ¨çº åï¼ˆä»…æ›´æ–° `size_bytes`ï¼Œé¿å…è§¦å‘å¤§è§„æ¨¡ç¼©ç•¥å›¾/ç¼“å­˜é‡å»ºï¼‰ã€‚
- å…¼å®¹ï¼šä¸æ”¹å˜å†å²å†…å®¹/å¯¼å‡º/å‹ç¼©ç­‰æ—¢æœ‰è¡Œä¸ºï¼›åŒæ­¥ä¸º best-effortï¼Œå¤±è´¥åªè®°å½•æ—¥å¿—ä¸å½±å“ä¸»æµç¨‹ã€‚

---

## ğŸ“‚ æ ¸å¿ƒæ”¹åŠ¨

- `Scopy/Services/StorageService.swift`
- `Scopy/Infrastructure/Persistence/SQLiteClipboardRepository.swift`
- `Scopy/Application/ClipboardService.swift`
- `Scopy/Domain/Protocols/ClipboardServiceProtocol.swift`
- `Scopy/Services/RealClipboardService.swift`
- `Scopy/Services/MockClipboardService.swift`
- `Scopy/Observables/SettingsViewModel.swift`
- `Scopy/Observables/HistoryViewModel.swift`
- `ScopyTests/StorageServiceTests.swift`

---

## âœ… æµ‹è¯•

- `xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests`ï¼šExecuted 277 tests, 25 skipped, 0 failures
- `make release-validate`ï¼šâœ…
