# v0.57.fix2

> 状态：✅
> 说明：Fix/Clipboard：修复 Excel 复制选中单元格时，历史误识别为图片（优先保留表格富文本/文本语义）。

## 📌 一页纸总结（What / Why / Result）

### What

- Fix/Clipboard：当剪贴板同时包含“图片预览 + Office 表格类 HTML/RTF/文本”时，优先存储富文本/文本语义，图片降级为兜底。
- Test：补齐回归测试，覆盖“表格 HTML + 图片”与“HTML `<img>` + 图片”两类场景。

### Why

- Office/Excel 复制单元格时经常会往剪贴板塞一个“图片预览”，但用户真正需要的是可粘贴的表格语义（HTML/RTF/TSV）。
- 如果 Scopy 先命中图片，会导致历史变成图片，后续粘贴到支持表格的目标应用时体验不符合预期。

### Result

- Excel 复制选中单元格后，Scopy 历史会优先记录为 HTML/RTF/文本（而不是图片），同时不影响真正的“复制图片”场景。

---

## 📂 核心改动

- `Scopy/Services/ClipboardMonitor.swift`（Excel/Office 表格信号识别；调整 Image vs Rich types 的优先级）
- `ScopyTests/ClipboardMonitorTests.swift`（新增表格复制回归测试）

---

## ✅ 测试

- `xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests`：Executed 283 tests, 25 skipped, 0 failures（2026-01-03）
