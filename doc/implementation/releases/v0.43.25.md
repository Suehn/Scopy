# v0.43.25 â€” Fix/Previewï¼šè®ºæ–‡å¼ LaTeX æ®µè½æ¸²æŸ“ä¿®å¤ï¼ˆé¿å…ç¯å¢ƒå†…æ³¨å…¥ `$`ï¼‰

**æ—¥æœŸ**ï¼š2025-12-16

## ğŸ“Œ ä¸€é¡µçº¸æ€»ç»“ï¼ˆWhat / Why / Resultï¼‰

### What

- **ä¿®å¤è®ºæ–‡å¼ LaTeX æ®µè½æ¸²æŸ“é”™è¯¯**ï¼š`MathNormalizer.wrapLooseLaTeX` ç°åœ¨ä¼šè·³è¿‡ `$$ ... $$` display å—ä¸ `\\begin{equation/align/...}` ç­‰ç¯å¢ƒå—çš„å†…éƒ¨å†…å®¹ï¼Œé¿å…æŠŠ `\\mathcal{...}` è¿™ç±»å‘½ä»¤é”™è¯¯åœ°è‡ªåŠ¨åŒ…è£¹ä¸º `$\\mathcal{...}$`ï¼Œä»è€Œå¯¼è‡´ KaTeX åœ¨ç¯å¢ƒå…¬å¼ä¸­å‡ºç°â€œåµŒå¥— `$`â€è§£æå¤±è´¥ã€‚
- **æ–°å¢å›å½’æµ‹è¯•**ï¼šåŠ å…¥å®Œæ•´è®ºæ–‡ç‰‡æ®µç”¨ä¾‹ï¼Œç¡®ä¿ç¯å¢ƒå…¬å¼å†…å®¹ä¸ä¼šè¢«æ³¨å…¥ä»»ä½• `$`ï¼Œå¦åˆ™æµ‹è¯•å¤±è´¥ã€‚

### Why

- ç”¨æˆ·åé¦ˆï¼šæ•´æ®µè®ºæ–‡å†…å®¹ï¼ˆ`\\subsection` + å¤šä¸ª `\\begin{equation}`ï¼‰åœ¨ hover é¢„è§ˆä¸­å‡ºç°å¤§ç‰‡çº¢è‰²é”™è¯¯æ¸²æŸ“ï¼Œæ ¹å› æ˜¯â€œloose LaTeXâ€ è‡ªåŠ¨è¡¥é½é€»è¾‘è¯¯ä¼¤ç¯å¢ƒå—å†…éƒ¨ã€‚

### Result

- `\\begin{equation} ... \\end{equation}` / `$$...$$` è¿™ä¸¤ç±»å—å†…çš„ TeX å†…å®¹ä¿æŒåŸæ ·ï¼ŒKaTeX ç¯å¢ƒå…¬å¼è§£æç¨³å®šæ€§æ˜æ˜¾æå‡ã€‚

---

## ğŸ—ï¸ å®ç°è¦ç‚¹

1. `MathNormalizer` å¢åŠ å¯¹å¤šè¡Œ `$$` block ä¸ LaTeX ç¯å¢ƒ block çš„çŠ¶æ€æœºè¯†åˆ«ï¼Œå—å†…ä¸åš â€œstandalone commandâ€ åŒ…è£¹ã€‚
2. `MathProtector` ç»§ç»­è´Ÿè´£ç¯å¢ƒå—æ•´ä½“å ä½ä¿æŠ¤ï¼Œé¿å… Markdown æ¸²æŸ“é˜¶æ®µæŠŠ delimiter æ‹†ç¢ã€‚

---

## ğŸ“‚ ä¿®æ”¹æ–‡ä»¶

- `Scopy/Views/History/MathNormalizer.swift`
- `ScopyTests/MarkdownMathRenderingTests.swift`
- `doc/implementation/README.md`
- `doc/implementation/CHANGELOG.md`

---

## âœ… æµ‹è¯•ä¸æ„å»º

**æµ‹è¯•ç¯å¢ƒ**ï¼šApple M3ï¼ˆ24 GBï¼‰ / macOS 15.7.2ï¼ˆ24G325ï¼‰ / Debug / 2025-12-16

- å®šå‘å•æµ‹ï¼š`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/MarkdownMathRenderingTests` âœ…

