# v0.50.fix18

> çŠ¶æ€ï¼šâœ…
> è¯´æ˜ï¼šFix/PNGï¼šä¿®å¤å‘å¸ƒåŒ…æœªå†…ç½® pngquant å¯¼è‡´å¯¼å‡º/ä¼˜åŒ–å¶å‘å¤±æ•ˆï¼›æ–°å¢å†å²å›¾ç‰‡æ‰‹åŠ¨ä¼˜åŒ–ï¼ˆè¦†ç›–åŸå›¾ + å‹ç¼©æ¯”æç¤ºï¼‰ï¼›å¹¶ä¿®å¤ hover ä¼˜åŒ–æŒ‰é’®è¯¯è§¦å‘é¢„è§ˆã€‚

## ğŸ“Œ ä¸€é¡µçº¸æ€»ç»“ï¼ˆWhat / Why / Resultï¼‰

### What

- Fix/Releaseï¼šæ„å»ºé˜¶æ®µå¼ºåˆ¶æŠŠ `Scopy/Resources/Tools/pngquant` ä¸ `Scopy/Resources/ThirdParty/pngquant/*` å¤åˆ¶è¿› app bundleï¼ˆ`Resources/Tools` / `Resources/ThirdParty`ï¼‰ï¼Œå¹¶ç¡®ä¿ `pngquant` å¯æ‰§è¡Œã€‚
- Feat/PNGï¼šå†å²å›¾ç‰‡æ–°å¢â€œä¼˜åŒ–å›¾ç‰‡ï¼ˆpngquantï¼‰â€æŒ‰é’®ï¼šå‹ç¼©å¹¶è¦†ç›– `content/` åŸå›¾ï¼ŒåŒæ—¶æ›´æ–° DB çš„ hash/size å¹¶åˆ·æ–° UIã€‚
- Fix/PNGï¼šå‹ç¼©å¤±è´¥å…œåº•ï¼šé‡åˆ°å†å²é—ç•™çš„â€œé PNG å´è½åœ¨ .png è·¯å¾„â€å…ˆå°è¯• TIFFâ†’PNG è½¬ç ï¼Œå†æ‰§è¡Œ pngquantï¼›è‹¥æœªå˜å°è‡ªåŠ¨å›æ»šã€‚
- UXï¼šhover åœ¨ä¼˜åŒ–æŒ‰é’®ä¸Šä¸å†è§¦å‘é¢„è§ˆ popoverï¼ˆé¿å…è¯¯å¼¹é¢„è§ˆå½±å“æ“ä½œï¼‰ã€‚

### Why

- v0.50.fix17 å¼•å…¥ pngquantï¼Œä½† release æ„å»ºå¯èƒ½æœªæŠŠ `Tools/pngquant` æ‰“è¿›åŒ…ï¼Œå¯¼è‡´å¯¼å‡ºé“¾è·¯â€œè¯·æ±‚å‹ç¼©ä½†å®é™…è·³è¿‡/å¤±è´¥â€ï¼Œç”¨æˆ·æ„ŸçŸ¥ä¸ºâ€œå‹ç¼©ä¸ç”Ÿæ•ˆ/å‹ç¼©å¤±è´¥â€ã€‚
- éƒ¨åˆ†å†å²å›¾ç‰‡å¯èƒ½å¹¶éçœŸå® PNGï¼ˆé—ç•™ TIFF payloadï¼‰ï¼Œç›´æ¥å¯¹æ–‡ä»¶è·¯å¾„è·‘ pngquant ä¼š hard-failã€‚

### Result

- å¯¼å‡º PNGï¼ˆMarkdown/LaTeXï¼‰ï¼šé»˜è®¤ pngquant å‹ç¼©åœ¨å†™å…¥å‰ªè´´æ¿å‰ç”Ÿæ•ˆï¼›å³ä½¿æœªå®‰è£…ç³»ç»Ÿ pngquantï¼Œä¹Ÿå¯ä½¿ç”¨å†…ç½®å·¥å…·ã€‚
- æ‰‹åŠ¨ä¼˜åŒ–ï¼šç‚¹å‡»åä¼šè¦†ç›– `content/` åŸå›¾å¹¶æç¤ºå‹ç¼©æ¯”ï¼›å¦‚æœæ²¡å˜å°ä¼šè‡ªåŠ¨å›æ»šå¹¶æ˜¾ç¤ºâ€œæ— å˜åŒ–â€ã€‚
- å…¼å®¹ï¼šå¤åˆ¶å›¾ç‰‡è¿›å…¥å†å²é»˜è®¤ä¸å‹ç¼©è¡Œä¸ºä¸å˜ï¼›å‹ç¼©é“¾è·¯ best-effortï¼Œä¸å½±å“æ—§ç‰ˆæœ¬çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

---

## ğŸ“‚ æ ¸å¿ƒæ”¹åŠ¨

- `Scopy/Services/PngquantService.swift`
- `Scopy/Application/ClipboardService.swift`
- `Scopy/Views/History/HistoryItemView.swift`
- `Scopy/Domain/Models/ImageOptimizationOutcomeDTO.swift`
- `Scopy/Domain/Models/ClipboardEvent.swift`
- `Scopy/Observables/HistoryViewModel.swift`
- `Scopy/Infrastructure/Persistence/SQLiteClipboardRepository.swift`
- `Scopy/Services/StorageService.swift`
- `project.yml`
- `Scopy.xcodeproj/project.pbxproj`

---

## âœ… æµ‹è¯•

- `xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests`ï¼šExecuted 276 tests, 25 skipped, 0 failures
- `make release-validate`ï¼šâœ…

