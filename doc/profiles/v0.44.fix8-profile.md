# v0.44.fix8 - Performance Profile

日期：2025-12-16

环境：
- `hw.model=Mac15,12`
- 内存：24GB
- macOS 15.7.2（24G325）
- Xcode 16.3（16E140）

## 结论（摘要）

- 本次改动主要是 Search 后端的“语义等价”性能与一致性修复：减少写入侧 FTS churn、降低查询侧 prepare 固定成本，并让深分页更稳定。
- 其中“FTS 写放大”与“深分页稳定性”的收益更偏长期/真实使用场景（高频更新 + 大库 + 深分页）；短跑 micro-benchmark 可能不明显。

## 指标

| 场景 | 指标 | 结果 |
|------|------|------|
| Disk 25k items（fuzzyPlus） | cold start | 720.22ms |
| Disk 25k items（fuzzyPlus） | P95 | 46.08ms（Samples: 60） |
| Service-path disk 10k items（fuzzyPlus） | cold start | 250.20ms |
| Service-path disk 10k items（fuzzyPlus） | P95 | 35.54ms（Samples: 50） |
| Long-doc exact（40 docs, ~15840 chars） | P95 | 0.21ms（Samples: 20） |

## 测试命令

- Disk 25k：`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/PerformanceTests/testDiskBackedSearchPerformance25k`
- Service-path disk 10k：`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/PerformanceTests/testServiceSearchPerformanceDisk10k`
- Long-doc exact：`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/PerformanceTests/testExactSearchPerformanceLongDocuments`

## 备注

- 性能数值对系统负载较敏感；如需精确对比，请在相同机器/相同电源模式/同一套测试命令下，对比 `v0.44.fix6` 与 `v0.44.fix8`。
