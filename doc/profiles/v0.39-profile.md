# v0.39 性能对比（v0.38 → v0.39）

**日期**: 2025-12-13

## 对比版本

- v0.38 → v0.39

## 测试环境

- 设备：Apple M3
- 系统：macOS 15.7.2（24G325）
- 架构：arm64
- 配置：Debug
- 命令：`make test-perf`（`RUN_PERF_TESTS=1`）
- 备注：heavy 场景需 `RUN_HEAVY_PERF_TESTS=1` 才运行

## 性能对比表格

| 指标 | v0.38 | v0.39 |
|------|------:|------:|
| Fuzzy 5k items P95 | 4.68ms | 4.66ms |
| Fuzzy 10k items P95 | 43.44ms | 45.63ms（Samples: 50） |
| Disk 25k fuzzy P95 | 56.15ms | 55.89ms |
| Bulk insert 1000 items | 82.69ms（≈12,094 items/s） | 54.96ms（≈18,195 items/s） |
| Fetch recent (50 items) avg | 0.07ms | 0.07ms |
| Regex 20k items P95 | 3.02ms | 3.04ms |
| Mixed content disk search（single run, after warmup） | 4.25ms | 4.06ms |

## 测试用例变化

- `testSearchPerformance10kItems`：采样从 5 → 50（10 rounds × 5 queries），用于降低一次性系统抖动导致的 P95 误报。
- 其余用例无新增/删除；本版本主要交付为 Strict Concurrency 回归与测试代码隔离修正，不改核心搜索/存储算法主路径。

## 性能回归说明

- 未观察到回归；指标整体在噪声范围内波动。
- Bulk insert 观测到显著提速，但本版本未刻意修改写入算法路径，建议视为系统噪声或环境差异，后续继续用相同环境多次运行确认趋势。

## 总结

- v0.39 主要交付是并发回归门槛（Strict Concurrency）与 perf 用例稳定性；性能指标仍满足 `v0.md` 目标。

