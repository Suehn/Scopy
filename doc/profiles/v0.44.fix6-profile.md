# v0.44.fix6 - Performance Profile

日期：2025-12-16

环境：
- `hw.model=Mac15,12`
- 内存：24GB
- macOS 15.7.2（24G325）
- Xcode 16.3（16E140）

## 结论（摘要）

- 本次改动为 Preview/Math 的正确性修复：避免对已插入的 `$...$` 数学段再次进行括号包裹，防止生成嵌套 `$` 导致 KaTeX parse error。
- 与搜索/存储性能路径无关；仍记录两条既有性能基线用例以防止无意回退。

## 指标

| 场景 | 指标 | 结果 |
|------|------|------|
| Disk 25k items（fuzzyPlus） | cold start | 693.32ms |
| Disk 25k items（fuzzyPlus） | P95 | 54.31ms（Samples: 60） |
| Long-doc exact（40 docs, ~15840 chars） | P95 | 0.22ms（Samples: 20） |

## 测试命令

- Disk 25k：`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/PerformanceTests/testDiskBackedSearchPerformance25k`
- Long-doc exact：`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests/PerformanceTests/testExactSearchPerformanceLongDocuments`

## 备注

- 该 profile 主要用于确保不相关改动不会引入性能回退；如需精确对比上一版本，可在相同机器上分别 checkout `v0.44.fix5` 与 `v0.44.fix6` 后重复上述两条命令并记录差值。
