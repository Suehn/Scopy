# v0.43.10 性能对比（v0.43.9 → v0.43.10）

**日期**: 2025-12-14

## 对比版本

- v0.43.9 → v0.43.10

## 测试环境

- 设备：MacBook Air（Mac15,12, 24 GB）
- 系统：macOS 15.7.2（24G325）
- 架构：arm64
- 配置：Debug
- 命令：`make test-perf`（`RUN_PERF_TESTS=1`）
- 电源：Low Power Mode disabled（`pmset -g` 显示 `lowpowermode 0`）

## 性能对比表格

> 说明：v0.43.10 调整了 perf 用例的“默认模式”与指标集合（以更贴近实际体验为目标），因此 v0.43.9 的部分数值 **不可直接横向比较**（模式从 `fuzzy` → `fuzzyPlus`，并新增 cold start / service-path 指标；同时本次运行 Low Power Mode 为关闭状态）。

| 指标 | v0.43.9 | v0.43.10 |
|------|--------:|--------:|
| Search 5k P95 | Fuzzy ≈ 8.41ms | FuzzyPlus ≈ 5.78ms |
| Search 10k P95 | Fuzzy ≈ 76.89ms（Samples: 50） | FuzzyPlus ≈ 54.00ms（Samples: 50） |
| Disk 25k P95 | fuzzy ≈ 108.72ms（Samples: 50） | fuzzyPlus ≈ 63.07ms（Samples: 60） |
| Bulk insert 1000 items | 82.99ms（≈12,050 items/s） | 62.75ms（≈15,935 items/s） |
| Fetch recent (50 items) avg | 0.11ms | 0.07ms |
| Regex 20k items P95 | 5.31ms | 3.32ms |
| Mixed content disk search（single run） | 7.50ms | 4.75ms |
| Search cold start 10k (fuzzyPlus) | - | 132.50ms |
| Disk cold start 25k (fuzzyPlus) | - | 710.09ms |
| Service-path disk 10k P95 (fuzzyPlus) | - | 48.86ms（Samples: 50） |
| Service-path disk 10k cold start (fuzzyPlus) | - | 255.02ms |

## 测试用例变化

- 搜索主用例默认改为 `fuzzyPlus`（与 Settings 默认一致），并新增 cold start 指标（全量索引构建）。
- 新增 `testServiceSearchPerformanceDisk10k`：走 `ClipboardService.search` 端到端路径（含 DTO 转换/actor hop）。
- `testDiskBackedSearchPerformance25k` 的数据分布更贴近真实场景（混入非 ASCII 文本与路径片段）。

## 性能回归说明

- 本版本改动主要在测试/基准维度，运行时逻辑不涉及热路径算法调整；表格变化更可能来自：
  - 用例模式与数据分布调整（`fuzzy` → `fuzzyPlus` + 新增 cold start/service-path）
  - 电源状态差异（v0.43.9 文档记录为 Low Power Mode enabled，本次为 disabled）

## 总结

- v0.43.10 的重点是让测试更稳定、更隔离，并把搜索性能基线改为更贴近实际用户体验的指标集合（默认 `fuzzyPlus` + cold start + service-path）。

