# v0.34 性能对比（v0.33 → v0.34）

**日期**: 2025-12-13

## 对比版本

- v0.33 → v0.34

## 测试环境

- 设备：Apple M3
- 系统：macOS 15.7.2（24G325）
- 架构：arm64
- 配置：Debug
- 命令：`make test-perf`（`RUN_PERF_TESTS=1`）
- 备注：heavy 场景需 `RUN_HEAVY_PERF_TESTS=1` 才运行

## 性能对比表格

| 指标 | v0.33 | v0.34 |
|------|------:|------:|
| Fuzzy 5k items P95 | 8.21ms | 8.48ms |
| Fuzzy 10k items P95 | 78.76ms | 77.49ms |
| Disk 25k fuzzy P95 | 107.50ms | 106.20ms |
| Bulk insert 1000 items | 83.15ms（≈12,027 items/s） | 82.25ms（≈12,158 items/s） |
| Fetch recent (50 items) avg | 0.11ms | 0.11ms |
| Regex 20k items P95 | 5.19ms | 5.17ms |

## 测试用例变化

- `ScopyTests/PerformanceTests.swift`：
  - `testMixedContentIndexingOnDisk` 增加 warmup 查询，降低一次性冷启动/抖动导致的误报。
  - 注意：该用例的“单次 elapsed”口径因此变化，不宜与旧版本直接做绝对值对比。

## 性能回归说明

- 本次变更集中在 UI 缓存入口收口（IconService/ThumbnailCache）与测试稳定性修正，未触及 Search/Storage 核心算法；在 `make test-perf` 覆盖的指标上无明显回归。

## 总结

- v0.34 的目标是“缓存入口单一化 + perf 用例更稳”，性能基线以本文件记录为准；heavy 场景可按需单独开启验证。

