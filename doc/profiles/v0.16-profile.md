# v0.16 性能对比与测试结果

## 测试环境
- 硬件：Mac（Apple Silicon，arm64）
- 系统：macOS 14.x+
- Xcode：15.x（SDK macOS 15.4）
- 日期：2025-11-29

## 自动化测试
- 单测：`xcodebuild test -scheme Scopy -destination 'platform=macOS' -only-testing:ScopyTests` → **161/161 通过（1 跳过，SearchServiceTests/testSearchPerformance5kItems 需 RUN_PERF_TESTS）**
- 性能断言：无失败，存在预警（见下）

## 性能实测数据（本轮）
- Bulk Insert：1000 items / **33.31ms**（30,019 items/s）
- Cleanup 50k：**270.67ms**
- Inline Cleanup 10k：P95 **61.11ms**（112.30 → 53.79ms）
- Cleanup 900：**3.69ms**
- External Cleanup 10k：**303.59ms**
- Disk Search 25k：P95 **24.92ms**
- Heavy Disk Search 50k：P95 **51.74ms**
- Ultra Disk Search 75k：P95 **112.49ms**
- Regex 20k：P95 **2.96ms**
- Search 10k：P95 **4.85ms**；Search 5k：Avg **1.87ms** / P95 **4.15ms**
- Short Query Cache：首查 **1.85ms** → 缓存 **0.83ms**
- Mixed Content Disk Search：**3.07ms**
- Fetch Recent：100 次（50/批） **5.67ms**，约 0.06ms/次
- First Screen Load：Avg **0.06ms** / P95 **0.07ms**
- Concurrent Read：100 ops **5.51ms**（18,156 ops/s）
- Dedup 200 upserts（100 unique/100 dup）：**4.10ms**
- External Storage Stress：外部占用 **65.5MB**，清理 **3.94ms**
- Memory Usage：初始 103.1MB → 105.5MB（+2.4MB，≈0KB/项）
- Memory Stability：500 迭代，103.1MB → 103.4MB（+0.3MB）
- Debounce：8 次快速查询 **7ms**（0.88ms/次）
- Search Mode（3k）：Exact 1.54ms / Fuzzy 1.44ms / Regex 3.62ms

## 预警（测试输出）
- Fetch latency 100ms > 35ms 目标（PerformanceAssertionsTests，模拟场景）。
- Search latency 60ms > 50ms（1k 场景），200ms > 150ms（50k 场景）预警。性能测试主体仍全部通过。

## 结论
- 所有单测与性能测试通过，无功能回归。
- 预警为断言提示，需在后续优化/调参时跟踪。当前性能指标满足 v0 目标。
